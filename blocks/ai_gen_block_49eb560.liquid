{% doc %}
  @prompt
    Create a video banner section with autoplay and hide controls options, overlay capability, and fallback image support. Include a content box positioned over the video with customizable label, heading, and CTA button link. The section should have settings for video autoplay toggle, controls visibility toggle, overlay opacity control, and fallback image upload. The content box should be positioned attractively over the video with proper styling and responsive design.

{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-video-banner-{{ ai_gen_id }} {
    position: relative;
    width: 100%;
    height: {{ block.settings.banner_height }}px;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: flex-start;
  }

  .ai-video-banner__video-{{ ai_gen_id }} {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    z-index: 1;
  }

  .ai-video-banner__fallback-{{ ai_gen_id }} {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    z-index: 1;
  }

  .ai-video-banner__fallback-placeholder-{{ ai_gen_id }} {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: #f4f4f4;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1;
  }

  .ai-video-banner__fallback-placeholder-{{ ai_gen_id }} svg {
    width: 100px;
    height: 100px;
    opacity: 0.5;
  }

  .ai-video-banner__overlay-{{ ai_gen_id }} {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, {{ block.settings.overlay_opacity | divided_by: 100.0 }});
    z-index: 2;
  }

  .ai-video-banner__content-{{ ai_gen_id }} {
    position: relative;
    z-index: 3;
    text-align: {{ block.settings.content_alignment }};
    color: {{ block.settings.content_text_color }};
    max-width: {{ block.settings.content_max_width }}px;
    padding: 0 140px;
    /* margin: 0 auto; */
        display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: 20px;
  }

  .ai-video-banner__label-{{ ai_gen_id }} {
    font-size: {{ block.settings.label_font_size }}px;
    margin-bottom: 0;
    text-transform: uppercase;
    letter-spacing: 0.32px;
    opacity: 1;
    font-family: 'Trade Gothic Next LT Pro';
    
  }

  .ai-video-banner__heading-{{ ai_gen_id }} {
    font-size: {{ block.settings.heading_font_size }}px;
    font-weight: 700;
    line-height: 1.2;
    margin: 0!important;
    margin: 0 !important;
    font-family: 'GT America Trial';
    letter-spacing: 0;
  }

  .ai-video-banner__button-{{ ai_gen_id }} {
    display: inline-block;
    padding: 16px 32px;
    background-color: {{ block.settings.button_background_color }};
    color: {{ block.settings.button_text_color }};
    text-decoration: none;
    border-radius: {{ block.settings.button_border_radius }}px;
    font-weight: 600;
    transition: all 0.3s ease;
    border: 2px solid {{ block.settings.button_background_color }};}

  .ai-video-banner__button-{{ ai_gen_id }}:hover {
    background-color: {{ block.settings.button_hover_background_color }};
    color: {{ block.settings.button_hover_text_color }};border-color: {{ block.settings.button_hover_background_color }};
    transform: translateY(-2px);
  }

  @media screen and (max-width: 768px) {
    .ai-video-banner-{{ ai_gen_id }} {
      height: {{ block.settings.banner_height_mobile }}px;
    }

    .ai-video-banner__content-{{ ai_gen_id }} {
      padding: 20px 16px;
      max-width: 100%;
    }

    .ai-video-banner__label-{{ ai_gen_id }} {
      font-size: {{ block.settings.label_font_size | times: 0.9 }}px;
    }

    .ai-video-banner__heading-{{ ai_gen_id }} {
      font-size: {{ block.settings.heading_font_size | times: 0.8 }}px;
    }

    .ai-video-banner__button-{{ ai_gen_id }} {
      padding: 14px 28px;}
  }

  @media screen and (max-width: 480px) {
    .ai-video-banner__heading-{{ ai_gen_id }} {
      font-size: {{ block.settings.heading_font_size | times: 0.7 }}px;
    }

    .ai-video-banner__label-{{ ai_gen_id }} {
      font-size: {{ block.settings.label_font_size | times: 0.8 }}px;
    }
  }
{% endstyle %}

<video-banner-{{ ai_gen_id }}
  class="ai-video-banner-{{ ai_gen_id }}"
  {{ block.shopify_attributes }}
>
  {% if block.settings.video_url != blank %}
    <video
      class="ai-video-banner__video-{{ ai_gen_id }}"
      {% if block.settings.autoplay %}autoplay{% endif %}
      {% unless block.settings.show_controls %}controls{% endunless %}
      muted
      loop
      playsinline
      preload="metadata"
    >
      <source src="{{ block.settings.video_url }}" type="video/mp4">
      {% if block.settings.fallback_image %}
        <img
          src="{{ block.settings.fallback_image | image_url: width: 2000 }}"
          alt="{{ block.settings.fallback_image.alt | escape }}"
          class="ai-video-banner__fallback-{{ ai_gen_id }}"
          loading="lazy"
        >
      {% else %}
        <div class="ai-video-banner__fallback-placeholder-{{ ai_gen_id }}">
          {{ 'hero-apparel-1' | placeholder_svg_tag }}
        </div>
      {% endif %}
    </video>
  {% else %}
    {% if block.settings.fallback_image %}
      <img
        src="{{ block.settings.fallback_image | image_url: width: 2000 }}"
        alt="{{ block.settings.fallback_image.alt | escape }}"
        class="ai-video-banner__fallback-{{ ai_gen_id }}"
        loading="lazy"width="{{ block.settings.fallback_image.width }}"
        height="{{ block.settings.fallback_image.height }}"
      >
    {% else %}
      <div class="ai-video-banner__fallback-placeholder-{{ ai_gen_id }}">
        {{ 'hero-apparel-1' | placeholder_svg_tag }}
      </div>
    {% endif %}
  {% endif %}

  {% if block.settings.overlay_opacity > 0 %}
    <div class="ai-video-banner__overlay-{{ ai_gen_id }}"></div>
  {% endif %}

  <div class="ai-video-banner__content-{{ ai_gen_id }}">
    {% if block.settings.label != blank %}
      <div class="ai-video-banner__label-{{ ai_gen_id }}">
        {{ block.settings.label }}
      </div>
    {% endif %}

    {% if block.settings.heading != blank %}
      <h2 class="ai-video-banner__heading-{{ ai_gen_id }}">
        {{ block.settings.heading }}
      </h2>
    {% endif %}

    {% if block.settings.button_text != blank and block.settings.button_link != blank %}
      <a
        href="{{ block.settings.button_link }}"
        class="
        button_custom
    size-style
    button
        "
        {% comment %}
          ai-video-banner__button-{{ ai_gen_id }}
        {% endcomment %}
      >
        {{ block.settings.button_text }}
      </a>
    {% endif %}
  </div>
</video-banner-{{ ai_gen_id }}>

<script>
  (function() {
    class VideoBanner{{ ai_gen_id }} extends HTMLElement {
      constructor() {
        super();
      }

      connectedCallback() {
        this.video = this.querySelector('.ai-video-banner__video-{{ ai_gen_id }}');
        this.setupVideo();
      }

      setupVideo() {
        if (!this.video) return;

        this.video.addEventListener('loadeddata', () => {
          this.video.style.opacity = '1';
        });

        this.video.addEventListener('error', () => {
          this.handleVideoError();
        });

        if (this.video.readyState >= 3) {
          this.video.style.opacity = '1';
        }
      }

      handleVideoError() {
        const fallback = this.querySelector('.ai-video-banner__fallback-{{ ai_gen_id }}');
        const placeholder = this.querySelector('.ai-video-banner__fallback-placeholder-{{ ai_gen_id }}');
        
        if (this.video) {
          this.video.style.display = 'none';}
        
        if (fallback) {
          fallback.style.display = 'block';
        } else if (placeholder) {
          placeholder.style.display = 'flex';
        }
      }
    }

    customElements.define('video-banner-{{ ai_gen_id }}', VideoBanner{{ ai_gen_id }});
  })();
</script>

{% schema %}
{
  "name": "Video Banner",
  "tag": null,
  "settings": [
    {
      "type": "header",
      "content": "Video Settings"
    },
    {
      "type": "url",
      "id": "video_url",
      "label": "Video URL",
      "info": "Upload your video file to Files in your admin and paste the URL here"
    },
    {
      "type": "checkbox",
      "id": "autoplay",
      "label": "Autoplay video",
      "default": true,
      "info": "Video will be muted for autoplay to work"
    },
    {
      "type": "checkbox",
      "id": "show_controls",
      "label": "Show video controls",
      "default": false
    },
    {
      "type": "image_picker",
      "id": "fallback_image",
      "label": "Fallback image",
      "info": "Shown when video fails to load or as backup"
    },
    {
      "type": "header",
      "content": "Overlay"
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "min": 0,
      "max": 80,
      "step": 5,
      "unit": "%",
      "label": "Overlay opacity",
      "default": 30
    },
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "text",
      "id": "label",
      "label": "Label"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Your Video Banner Heading"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button text",
      "default": "Shop Now"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Button link"
    },
    {
      "type": "select",
      "id": "content_alignment",
      "label": "Content alignment",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ],
      "default": "center"
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "range",
      "id": "banner_height",
      "min": 300,
      "max": 800,
      "step": 50,
      "unit": "px",
      "label": "Banner height (desktop)",
      "default": 600
    },
    {
      "type": "range",
      "id": "banner_height_mobile",
      "min": 200,
      "max": 600,
      "step": 25,
      "unit": "px",
      "label": "Banner height (mobile)",
      "default": 400
    },
    {
      "type": "range",
      "id": "content_max_width",
      "min": 300,
      "max": 900,
      "step": 50,
      "unit": "px",
      "label": "Content max width",
      "default": 600
    },
    {
      "type": "header",
      "content": "Typography"
    },
    {
      "type": "range",
      "id": "label_font_size",
      "min": 10,
      "max": 24,
      "step": 1,
      "unit": "px",
      "label": "Label font size",
      "default": 14
    },
    {
      "type": "range",
      "id": "heading_font_size",
      "min": 20,
      "max": 80,
      "step": 2,
      "unit": "px",
      "label": "Heading font size",
      "default": 48
    },
    {
      "type": "color",
      "id": "content_text_color",
      "label": "Text color",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Button Style"
    },
    {
      "type": "color",
      "id": "button_background_color",
      "label": "Button background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Button text color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "button_hover_background_color",
      "label": "Button hover background",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "button_hover_text_color",
      "label": "Button hover text color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "button_border_radius",
      "min": 0,
      "max": 50,
      "step": 2,
      "unit": "px",
      "label": "Button border radius",
      "default": 8
    }
  ],
  "presets": [
    {
      "name": "Video Banner"
    }
  ]
}
{% endschema %}